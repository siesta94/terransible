---
- hosts: dev
  become: yes
  remote_user: ubuntu
  tasks:
    - name: Update Cache
      apt:
        name: php7.2
        update_cache: yes
    - name: Install Apache.
      apt: name={{ item }} state=present
      with_items:
      - apache2
      - php7.2-mysql
    - name: Download WordPress
      get_url: url=http://wordpress.org/wordpress-latest.tar.gz dest=/var/www/html/wordpress.tar.gz force=yes
    - name: Extract WordPress
      command: "tar xzf /var/www/html/wordpress.tar.gz -C /var/www/html --strip-components 1"
    - name: Remove default index.html
      command: "rm -rf /var/www/html/index.html"
    - name: Make my directory tree readable
      file:
        path: /var/www/html/
        mode: u=rwX,g=rX,o=rX
        recurse: yes
        owner: www-data
        group: www-data
    - name: Restart Apache2
      service:
        name: apache2
        state: restarted
    - name: Make sure Apache is started now and at boot.
      service: name=apache2 state=started enabled=yes
